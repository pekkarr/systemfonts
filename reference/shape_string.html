<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate glyph positions for strings — shape_string • systemfonts</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate glyph positions for strings — shape_string"><meta property="og:description" content="Do basic text shaping of strings. This function will use freetype to
calculate advances, doing kerning if possible. It will not perform any font
substitution or ligature resolving and will thus be much in line with how
the standard graphic devices does text shaping. Inputs are recycled to the
length of strings."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">systemfonts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/c_interface.html">systemfonts C interface</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/r-lib/systemfonts/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate glyph positions for strings</h1>
    <small class="dont-index">Source: <a href="https://github.com/r-lib/systemfonts/blob/HEAD/R/shape_string.R" class="external-link"><code>R/shape_string.R</code></a></small>
    <div class="hidden name"><code>shape_string.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Do basic text shaping of strings. This function will use freetype to
calculate advances, doing kerning if possible. It will not perform any font
substitution or ligature resolving and will thus be much in line with how
the standard graphic devices does text shaping. Inputs are recycled to the
length of <code>strings</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">shape_string</span><span class="op">(</span>
  <span class="va">strings</span>,
  id <span class="op">=</span> <span class="cn">NULL</span>,
  family <span class="op">=</span> <span class="st">""</span>,
  italic <span class="op">=</span> <span class="cn">FALSE</span>,
  bold <span class="op">=</span> <span class="cn">FALSE</span>,
  size <span class="op">=</span> <span class="fl">12</span>,
  res <span class="op">=</span> <span class="fl">72</span>,
  lineheight <span class="op">=</span> <span class="fl">1</span>,
  align <span class="op">=</span> <span class="st">"left"</span>,
  hjust <span class="op">=</span> <span class="fl">0</span>,
  vjust <span class="op">=</span> <span class="fl">0</span>,
  width <span class="op">=</span> <span class="cn">NA</span>,
  tracking <span class="op">=</span> <span class="fl">0</span>,
  indent <span class="op">=</span> <span class="fl">0</span>,
  hanging <span class="op">=</span> <span class="fl">0</span>,
  space_before <span class="op">=</span> <span class="fl">0</span>,
  space_after <span class="op">=</span> <span class="fl">0</span>,
  path <span class="op">=</span> <span class="cn">NULL</span>,
  index <span class="op">=</span> <span class="fl">0</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>strings</dt>
<dd><p>A character vector of strings to shape</p></dd>
<dt>id</dt>
<dd><p>A vector grouping the strings together. If strings share an id the
shaping will continue between strings</p></dd>
<dt>family</dt>
<dd><p>The name of the font family</p></dd>
<dt>italic</dt>
<dd><p>logicals indicating the font style</p></dd>
<dt>bold</dt>
<dd><p>logicals indicating the font style</p></dd>
<dt>size</dt>
<dd><p>The pointsize of the font to use for size related measures</p></dd>
<dt>res</dt>
<dd><p>The ppi of the size related mesures</p></dd>
<dt>lineheight</dt>
<dd><p>A multiplier for the lineheight</p></dd>
<dt>align</dt>
<dd><p>Within text box alignment, either <code>'left'</code>, <code>'center'</code>, or
<code>'right'</code></p></dd>
<dt>hjust, vjust</dt>
<dd><p>The justification of the textbox surrounding the text</p></dd>
<dt>width</dt>
<dd><p>The requested with of the string in inches. Setting this to
something other than <code>NA</code> will turn on word wrapping.</p></dd>
<dt>tracking</dt>
<dd><p>Tracking of the glyphs (space adjustment) measured in 1/1000
em.</p></dd>
<dt>indent</dt>
<dd><p>The indent of the first line in a paragraph measured in inches.</p></dd>
<dt>hanging</dt>
<dd><p>The indent of the remaining lines in a paragraph measured in
inches.</p></dd>
<dt>space_before, space_after</dt>
<dd><p>The spacing above and below a paragraph,
measured in points</p></dd>
<dt>path, index</dt>
<dd><p>path an index of a font file to circumvent lookup based on
family and style</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with two element: <code>shape</code> contains the position of each glyph,
relative to the origin in the enclosing textbox. <code>metrics</code> contain metrics
about the full strings.
<code>shape</code> is a data.frame with the following columns:</p><dl><dt>glyph</dt>
<dd><p>The glyph as a character</p></dd>

<dt>index</dt>
<dd><p>The index of the glyph in the font file</p></dd>

<dt>metric_id</dt>
<dd><p>The index of the string the glyph is part of (referencing a row in the <code>metrics</code> data.frame)</p></dd>

<dt>string_id</dt>
<dd><p>The index of the string the glyph came from (referencing an element in the <code>strings</code> input)</p></dd>

<dt>x_offset</dt>
<dd><p>The x offset in pixels from the origin of the textbox</p></dd>

<dt>y_offset</dt>
<dd><p>The y offset in pixels from the origin of the textbox</p></dd>

<dt>x_mid</dt>
<dd><p>The x offset in pixels to the middle of the glyph, measured from the origin of the glyph</p></dd>


</dl><p><code>metrics</code> is a data.frame with the following columns:</p><dl><dt>string</dt>
<dd><p>The text the string consist of</p></dd>

<dt>width</dt>
<dd><p>The width of the string</p></dd>

<dt>height</dt>
<dd><p>The height of the string</p></dd>

<dt>left_bearing</dt>
<dd><p>The distance from the left edge of the textbox and the leftmost glyph</p></dd>

<dt>right_bearing</dt>
<dd><p>The distance from the right edge of the textbox and the rightmost glyph</p></dd>

<dt>top_bearing</dt>
<dd><p>The distance from the top edge of the textbox and the topmost glyph</p></dd>

<dt>bottom_bearing</dt>
<dd><p>The distance from the bottom edge of the textbox and the bottommost glyph</p></dd>

<dt>left_border</dt>
<dd><p>The position of the leftmost edge of the textbox related to the origin</p></dd>

<dt>top_border</dt>
<dd><p>The position of the topmost edge of the textbox related to the origin</p></dd>

<dt>pen_x</dt>
<dd><p>The horizontal position of the next glyph after the string</p></dd>

<dt>pen_y</dt>
<dd><p>The vertical position of the next glyph after the string</p></dd>


</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">string</span> <span class="op">&lt;-</span> <span class="st">"This is a long string\nLook; It spans multiple lines\nand all"</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Shape with default settings</span></span>
<span class="r-in"><span class="fu">shape_string</span><span class="op">(</span><span class="va">string</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $shape</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 59 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    glyph index metric_id string_id x_offset y_offset x_midpoint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span>T<span style="color: #949494;">"</span>      55         0         1        0     27.9        3.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span>h<span style="color: #949494;">"</span>      75         0         1        7     27.9        4  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>i<span style="color: #949494;">"</span>      76         0         1       15     27.9        1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>s<span style="color: #949494;">"</span>      86         0         1       18     27.9        3  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span> <span style="color: #949494;">"</span>       3         0         1       24     27.9        2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>i<span style="color: #949494;">"</span>      76         0         1       28     27.9        1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>s<span style="color: #949494;">"</span>      86         0         1       31     27.9        3  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span> <span style="color: #949494;">"</span>       3         0         1       37     27.9        2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>a<span style="color: #949494;">"</span>      68         0         1       41     27.9        3.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span> <span style="color: #949494;">"</span>       3         0         1       48     27.9        2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 49 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $metrics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   string      width height left_bearing right_bearing top_bearing bottom_bearing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">"</span>This is a…   168   53.0           -<span style="color: #BB0000;">1</span>             0        1.14           2.83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 4 more variables: left_border &lt;dbl&gt;, top_border &lt;dbl&gt;, pen_x &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pen_y &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Mix styles within the same string</span></span>
<span class="r-in"><span class="va">string</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span class="r-in">  <span class="st">"This string will have\na "</span>,</span>
<span class="r-in">  <span class="st">"very large"</span>,</span>
<span class="r-in">  <span class="st">" text style\nin the middle"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">shape_string</span><span class="op">(</span><span class="va">string</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">24</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $shape</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 59 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    glyph index metric_id string_id x_offset y_offset x_midpoint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span>T<span style="color: #949494;">"</span>      55         0         1        0     41.9        3.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span>h<span style="color: #949494;">"</span>      75         0         1        7     41.9        4  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>i<span style="color: #949494;">"</span>      76         0         1       15     41.9        1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>s<span style="color: #949494;">"</span>      86         0         1       18     41.9        3  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span> <span style="color: #949494;">"</span>       3         0         1       24     41.9        2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>s<span style="color: #949494;">"</span>      86         0         1       28     41.9        3  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>t<span style="color: #949494;">"</span>      87         0         1       34     41.9        2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>r<span style="color: #949494;">"</span>      85         0         1       39     41.9        2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>i<span style="color: #949494;">"</span>      76         0         1       44     41.9        1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>n<span style="color: #949494;">"</span>      81         0         1       47     41.9        4  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 49 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $metrics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   string      width height left_bearing right_bearing top_bearing bottom_bearing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">"</span>This stri…   194   67.0           -<span style="color: #BB0000;">1</span>             0        1.14           2.83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 4 more variables: left_border &lt;dbl&gt;, top_border &lt;dbl&gt;, pen_x &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pen_y &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thomas Lin Pedersen, Jeroen Ooms, Devon Govett.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

